<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Aprèn JavaScript Interactiu</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">

  <style>
    body {
     /* background-color: #f8f9fa;*/
    }

    textarea {
      resize: none;
      font-family: monospace;
      font-size: 14px;
      padding: 0.75rem;
    }

    .panel-header {
      font-weight: bold;
   /*   background-color: #f1f1f1;*/
      border-bottom: 1px solid #dee2e6;
      padding: 0.5rem 1rem;
    }

    iframe {
      width: 100%;
      height: 400px;
      border: 1px solid #dee2e6;
      border-radius: 0 0 8px 8px;
    }

    .card {
      height: 100%;
    }

    @media (max-width: 768px) {
      iframe {
        height: 300px;
      }
    }
  </style>
</head>

<body>
  <div id="navbar-placeholder"></div>

  <main class="container py-4">
    <header class="mb-4">
      <h1 class="mb-3">Aprèn JavaScript de Forma Interactiva</h1>
      <div class="row gy-2 align-items-end">
        <div class="col-md-6">
          <label for="example-select" class="form-label"><strong>Tria un exemple:</strong></label>
          <select id="example-select" class="form-select">
            <option value="alerta">1. Alerta Simple</option>
            <option value="canvi_text">2. Canviar Text</option>
            <option value="color">3. Canviar Color</option>
            <option value="comptador">4. Comptador</option>
            <option value="interaccio">5. Click d’un Botó</option>
            <option value="afegir">6. Afegir HTML Dinàmicament</option>
            <option value="mostrar_ocultar">7. Mostrar / Ocultar Element</option>
            <option value="canvi_imatge">8. Canvi d’Imatge</option>
            <option value="mouse">9. Esdeveniments del Ratolí</option>
            <option value="cronometre">10. Cronòmetre</option>
          </select>
        </div>
        <div class="col-md-2">
          <button id="run-btn" class="btn btn-primary w-100"><i class="fa fa-play me-1"></i>Executa</button>
        </div>
      </div>
    </header>

    <div class="row g-4">
      <div class="col-md-4">
        <div class="card shadow-sm h-100">
          <div class="panel-header">HTML</div>
          <textarea id="html-code" class="form-control border-0 border-top" rows="10" spellcheck="false"></textarea>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card shadow-sm h-100">
          <div class="panel-header">CSS</div>
          <textarea id="css-code" class="form-control border-0 border-top" rows="10" spellcheck="false"></textarea>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card shadow-sm h-100">
          <div class="panel-header">JavaScript</div>
          <textarea id="js-code" class="form-control border-0 border-top" rows="10" spellcheck="false"></textarea>
        </div>
      </div>
    </div>

    <div class="card shadow-sm mt-4">
      <div class="panel-header">Resultat</div>
      <iframe id="preview" class="border-0"></iframe>
    </div>
  </main>

  <!-- Scripts -->
  <script>
    const htmlCode = document.getElementById('html-code');
    const cssCode = document.getElementById('css-code');
    const jsCode = document.getElementById('js-code');
    const preview = document.getElementById('preview');
    const runBtn = document.getElementById('run-btn');
    const exampleSelect = document.getElementById('example-select');

    const examples = {
      alerta: {
        html: `<button onclick="alert('Hola!')">Fes clic</button>`,
        css: `button { font-size: 16px; padding: 10px; }`,
        js: `// No cal JavaScript aquí perquè es fa servir directament a l'HTML`
      },
      canvi_text: {
        html: `<p id="text">Text original</p>\n<button onclick="canvia()">Canvia text</button>`,
        css: `p { font-weight: bold; }`,
        js: `function canvia() {\n  document.getElementById('text').innerText = "Text canviat!";\n}`
      },
      color: {
        html: `<div id="box">Canvia'm el color</div>\n<button onclick="canviaColor()">Canvia color</button>`,
        css: `#box { width: 100%; height: 100px; background: lightgray; margin-bottom: 10px; }`,
        js: `function canviaColor() {\n  document.getElementById('box').style.background = "#66bb6a";\n}`
      },
      comptador: {
        html: `<p id="compte">0</p>\n<button onclick="incrementa()">+1</button>`,
        css: `p { font-size: 24px; }`,
        js: `let valor = 0;\nfunction incrementa() {\n  valor++;\n  document.getElementById('compte').innerText = valor;\n}`
      },
      interaccio: {
        html: `<button id="boton">Fes clic</button>\n<p id="resposta"></p>`,
        css: ``,
        js: `document.getElementById('boton').onclick = () => {\n  document.getElementById('resposta').innerText = "Has fet clic!";\n};`
      },
      afegir: {
        html: `<div id="contenidor"></div>\n<button onclick="afegeix()">Afegeix paràgraf</button>`,
        css: ``,
        js: `function afegeix() {\n  const p = document.createElement('p');\n  p.textContent = "Nou paràgraf";\n  document.getElementById('contenidor').appendChild(p);\n}`
      },
      mostrar_ocultar: {
        html: `<p id="text">Aquest text es pot ocultar.</p>\n<button onclick="toggle()">Mostra/Oculta</button>`,
        css: ``,
        js: `function toggle() {\n  const el = document.getElementById('text');\n  el.style.display = el.style.display === "none" ? "block" : "none";\n}`
      },
      canvi_imatge: {
        html: `<img id="img" src="https://via.placeholder.com/200x100" onmouseover="canvia()" onmouseout="torna()">`,
        css: `img { cursor: pointer; }`,
        js: `function canvia() {\n  document.getElementById('img').src = "https://via.placeholder.com/200x100/ff6666";\n}\nfunction torna() {\n  document.getElementById('img').src = "https://via.placeholder.com/200x100";\n}`
      },
      mouse: {
        html: `<div id="zona">Passa el ratolí per aquí</div>`,
        css: `#zona { padding: 40px; background: #e0e0e0; text-align: center; }`,
        js: `const zona = document.getElementById('zona');\nzona.onmouseenter = () => zona.style.background = "#90caf9";\nzona.onmouseleave = () => zona.style.background = "#e0e0e0";`
      },
      cronometre: {
        html: `<p id="temps">0</p>\n<button onclick="inicia()">Inicia</button>\n<button onclick="atura()">Atura</button>`,
        css: `p { font-size: 24px; }`,
        js: `let temps = 0;\nlet interval;\nfunction inicia() {\n  interval = setInterval(() => {\n    temps++;\n    document.getElementById('temps').innerText = temps;\n  }, 1000);\n}\nfunction atura() {\n  clearInterval(interval);\n}`
      }
    };

    function render() {
      const html = htmlCode.value;
      const css = cssCode.value;
      const js = jsCode.value;

      localStorage.setItem('html', html);
      localStorage.setItem('css', css);
      localStorage.setItem('js', js);

      const fullCode = `
        <html>
        <head><style>${css}</style></head>
        <body>
        ${html}
        <script>${js}<\/script>
        </body>
        </html>
      `;
      preview.srcdoc = fullCode;
    }

    function loadExample(key) {
      const ex = examples[key];
      htmlCode.value = ex.html;
      cssCode.value = ex.css;
      jsCode.value = ex.js;
      render();
    }

    function loadFromStorage() {
      if (localStorage.getItem('html')) {
        htmlCode.value = localStorage.getItem('html');
        cssCode.value = localStorage.getItem('css');
        jsCode.value = localStorage.getItem('js');
        render();
      } else {
        loadExample('alerta');
      }
    }

    exampleSelect.addEventListener('change', () => loadExample(exampleSelect.value));
    runBtn.addEventListener('click', render);

    loadFromStorage();
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../navbar.js"></script>
</body>
</html>

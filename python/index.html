b<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Un intèrpret de Python (REPL) interactiu amb exemples per aprendre, utilitzant Pyodide.">

    <title>Aprèn Python amb Pyodide REPL</title>

    <script src="https://cdn.jsdelivr.net/pyodide/v0.28.0/full/pyodide.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        :root {
            --padding-base: 10px;
        }
        body, html {
            height: 100%;
            margin: 0;
            display: flex;
            flex-direction: column;
        }
        main {
            flex-grow: 1;
        }
        #code, #output {
            width: 100%;
            flex: 1;
            resize: none;
            font-family: monospace;
            border-radius: 5px;
            border: 1px solid #ccc;
            padding: 5px;
            min-height: 150px; /* Alçada mínima per evitar col·lapse */
        }
        #output-section, #repl-container {
            padding: var(--padding-base);
            box-sizing: border-box;
        }
        #repl-container {
            display: flex;
            flex-direction: column;
            height: 60%;
        }
        #output-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: auto;
            min-height: 200px;
        }
    </style>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <link rel="stylesheet" href="../styles.css">
</head>
<body>
<div id="navbar-placeholder"></div>

  <main class="container py-4">

 
  <main class="container py-4">

    <div id="repl-container">
        <div class="mb-3">
            <label for="exemple-selector" class="form-label">Tria un exemple per aprendre o comença des de zero:</label>
            <select id="exemple-selector" class="form-select">
                <option value="hola_mon">1. Hola, Món!</option>
                <option value="variables">2. Variables i Text Formatat (f-strings)</option>
                <option value="bucles">3. Bucles 'for' i Llistes</option>
                <option value="funcions">4. Definir i Cridar Funcions</option>
                <option value="quadratica">5. Exemple Avançat (Equació Quadràtica)</option>
                <hr>
                <option value="condicionals">6. Condicionals (if, elif, else)</option>
                <option value="diccionaris">7. Diccionaris</option>
                <option value="bucle_while">8. Bucle 'while'</option>
                <option value="list_comprehension">9. List Comprehensions</option>
                <option value="metodes_string">10. Mètodes de Strings</option>
                <option value="tuples">11. Tuples (immutables)</option>
                <option value="sets">12. Conjunts (Sets)</option>
                <option value="errors">13. Gestió d'Errors (try, except)</option>
                <option value="moduls">14. Importar Mòduls (random)</option>
                <option value="classes">15. Classes i Objectes (Bàsic)</option>
                <hr>
                <option value="personalitzat">16. Escriu el teu propi codi (en blanc)</option>
            </select>
        </div>

        <label for="code">Codi Python:</label>
        <textarea id="code" rows="15"></textarea>
        <button id="run-button" class="btn btn-primary mt-3 align-self-start" onclick="evaluatePython()">Executa el Codi</button>
    </div>

    <div id="output-section" aria-live="polite">
        <label for="output">Sortida:</label>
        <textarea id="output" rows="10" readonly></textarea>
    </div>

  </main>

  <script>
    // Referències als elements del DOM
    const output = document.getElementById("output");
    const code = document.getElementById("code");
    const runButton = document.getElementById("run-button");
    const exempleSelector = document.getElementById("exemple-selector");

    // Objecte amb els fragments de codi dels exemples
    const exemplesCodi = {
        'hola_mon': `print("Hola, Món!")
# Aquesta línia imprimeix un missatge a la consola de sortida.
# És el primer pas clàssic per aprendre qualsevol llenguatge!`,

        'variables': `nom = "Àlex"
edat = 28

# Les f-strings (format strings) permeten inserir variables dins d'un text fàcilment.
print(f"Hola, em dic {nom} i tinc {edat} anys.")`,

        'bucles': `fruites = ["poma", "plàtan", "cirera", "taronja"]

print("La meva cistella de fruites té:")
# Un bucle 'for' recorre cada element d'una llista (o un altre objecte iterable).
for fruita in fruites:
    print(f"- {fruita}")`,

        'funcions': `# Definim una funció per saludar.
# 'nom' és un paràmetre que la funció espera rebre.
def saludar(nom):
  return f"Hola, {nom}! Benvingut/da a Python."

# Ara cridem la funció amb diferents arguments.
missatge1 = saludar("Jordi")
print(missatge1)

missatge2 = saludar("Marta")
print(missatge2)`,
      
        'quadratica': `import math

def resoldre_quadratica(a, b, c):
    """Aquesta funció resol una equació de segon grau: ax^2 + bx + c = 0"""
    discriminant = b**2 - 4*a*c
    if discriminant >= 0:
        arrel1 = (-b + math.sqrt(discriminant)) / (2*a)
        arrel2 = (-b - math.sqrt(discriminant)) / (2*a)
        return f"Les arrels són: {arrel1} i {arrel2}"
    else:
        return "No hi ha arrels reals."

# Prova la funció amb aquests valors o canvia'ls!
resultat = resoldre_quadratica(1, -5, 6) # x^2 - 5x + 6 = 0
print(resultat)`,
        
        // --- INICI DELS NOUS APARTATS ---
        
        'condicionals': `# Els condicionals permeten executar codi només si es compleix una condició.
# Prova a canviar el valor de 'numero' per veure resultats diferents.
numero = 5

if numero > 0:
    print("El número és positiu.")
elif numero == 0:
    print("El número és zero.")
else:
    print("El número és negatiu.")`,

        'diccionaris': `# Un diccionari emmagatzema parells clau-valor.
capitals = {
    "Catalunya": "Barcelona",
    "França": "París",
    "Japó": "Tòquio"
}

# Accedim a un valor a través de la seva clau.
capital_frança = capitals["França"]
print(f"La capital de França és {capital_frança}.")

# Podem recórrer un diccionari amb un bucle 'for'.
for pais, capital in capitals.items():
    print(f"- La capital de {pais} és {capital}.")`,
    
        'bucle_while': `# Un bucle 'while' s'executa mentre una condició sigui certa.
# És útil quan no sabem quantes vegades s'ha de repetir el bucle.
comptador = 5
print("Compte enrere:")

while comptador > 0:
    print(comptador)
    comptador = comptador - 1 # O també: comptador -= 1

print("Fet!")`,
    
        'list_comprehension': `# Les 'list comprehensions' són una forma concisa de crear llistes.
numeros = [1, 2, 3, 4, 5]

# Forma tradicional amb un bucle 'for':
quadrats_tradicional = []
for n in numeros:
    quadrats_tradicional.append(n**2)
print(f"Llista tradicional: {quadrats_tradicional}")

# La mateixa operació amb una 'list comprehension':
quadrats_concis = [n**2 for n in numeros]
print(f"Amb list comprehension: {quadrats_concis}")`,

        'metodes_string': `# Els strings (text) tenen mètodes útils incorporats.
frase = "Python és un llenguatge de programació popular."

# Convertir a majúscules
print(f"Majúscules: {frase.upper()}")

# Trobar la posició d'una paraula (comença a comptar des de 0)
print(f"La paraula 'llenguatge' comença a la posició: {frase.find('llenguatge')}")

# Reemplaçar una part del text
nova_frase = frase.replace("popular", "increïble")
print(f"Frase modificada: {nova_frase}")`,

        'tuples': `# Una tupla és com una llista, però els seus elements no es poden canviar (és immutable).
# Es defineixen amb parèntesis.
coordenades = (41.3874, 2.1686) # Coordenades de Barcelona

print(f"Latitud: {coordenades[0]}")
print(f"Longitud: {coordenades[1]}")

# Aquesta línia provocaria un error perquè les tuples no es poden modificar:
# coordenades[0] = 40.4168 # Descomenta per veure l'error
print("Intentar modificar una tupla causa un TypeError.")`,
        
        'sets': `# Un conjunt (set) és una col·lecció d'elements únics i desordenats.
# Són útils per eliminar duplicats d'una llista.
llista_amb_duplicats = [1, 2, 2, 3, 4, 4, 4, 5, 1]
print(f"Llista original: {llista_amb_duplicats}")

# Creem un conjunt a partir de la llista per obtenir els elements únics.
elements_unics = set(llista_amb_duplicats)
print(f"Conjunt d'elements únics: {elements_unics}")`,

        'errors': `# El bloc 'try...except' permet gestionar errors que poden passar durant l'execució.
# Això evita que el programa es bloquegi.
def dividir(a, b):
    try:
        resultat = a / b
        print(f"El resultat de {a}/{b} és {resultat}")
    except ZeroDivisionError:
        print("Error: No es pot dividir per zero!")

# Aquesta operació funcionarà
dividir(10, 2)

# Aquesta causarà un error, però el programa el gestionarà correctament.
dividir(10, 0)`,

        'moduls': `import random # El mòdul 'random' permet generar números aleatoris.

# Generar un número enter aleatori entre 1 i 10
numero_aleatori = random.randint(1, 10)
print(f"El meu número aleatori entre 1 i 10 és: {numero_aleatori}")

# Escollir un element aleatori d'una llista
opcions = ["pedra", "paper", "tisores"]
eleccio_ordinador = random.choice(opcions)
print(f"L'ordinador ha triat: {eleccio_ordinador}")`,
        
        'classes': `# Les classes són plantilles per crear objectes.
# Un objecte té propietats (atributs) i accions (mètodes).

class Gos:
    # El mètode '__init__' és el constructor, s'executa en crear un objecte.
    def __init__(self, nom, edat):
        self.nom = nom
        self.edat = edat

    # Aquest és un mètode (una funció dins d'una classe).
    def bordar(self):
        return f"{self.nom} diu: Bup, bup!"

# Creem dos objectes (instàncies) de la classe Gos.
gos1 = Gos("Milú", 4)
gos2 = Gos("Idèfix", 7)

print(f"{gos1.nom} té {gos1.edat} anys.")
print(gos2.bordar())`,
        
        // --- FI DELS NOUS APARTATS ---

        'personalitzat': `# Escriu aquí el teu propi codi de Python
# Per exemple, prova a sumar dos números:
#
# print(123 + 456)
#
# O crea una llista de les teves pel·lícules preferides i mostra-la!`
    };

    // Funció per actualitzar l'àrea de codi quan es canvia el menú
    function actualitzarCodiSeleccionat() {
        const clauSeleccionada = exempleSelector.value;
        code.value = exemplesCodi[clauSeleccionada];
    }

    // Afegim un 'event listener' al menú desplegable
    exempleSelector.addEventListener('change', actualitzarCodiSeleccionat);


    // ---- Lògica de Pyodide ----

    function addToOutput(s) {
        if (typeof s !== 'undefined') {
          output.value += `${s}\n`;
        }
        output.scrollTop = output.scrollHeight;
    }

    async function evaluatePython() {
        addToOutput(`>>> Executant el codi...`);
        runButton.disabled = true;
        runButton.innerText = "Executant...";

        try {
            if (!window.pyodide) {
                addToOutput("Pyodide no s'ha carregat encara. Espera un moment.");
                return;
            }
            await window.pyodide.loadPackagesFromImports(code.value);
            let result = await window.pyodide.runPythonAsync(code.value);
            addToOutput(result);
        } catch (error) {
            addToOutput(error);
        } finally {
            runButton.disabled = false;
            runButton.innerText = "Executa el Codi";
            addToOutput("--- Finalitzat ---");
        }
    }

    (async () => {
        addToOutput('Inicialitzant Pyodide (pot trigar uns segons)...');
        try {
            window.pyodide = await loadPyodide({
                stdout: addToOutput,
                stderr: addToOutput
            });
            addToOutput('A punt! Tria un exemple o escriu el teu codi.');
            // Carrega el primer exemple per defecte en iniciar
            actualitzarCodiSeleccionat();
        } catch (error) {
            addToOutput(`Error en inicialitzar Pyodide: ${error}`);
        }
    })();
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</main>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="../navbar.js"></script>
  </body>
</html>
